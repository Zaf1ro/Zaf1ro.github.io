<!DOCTYPE html>
<html lang="zh">
  <head>
    
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">



  <meta name="description" content="Parser (1)"/>




  <meta name="keywords" content="Compiler," />


<meta name="google-site-verification" content="qy4gf0StWj627u-7aIP3WDCLBi3jPYXhm57UC7TUcok" />
<meta name="baidu-site-verification" content="XJoPG7ad2Z" />

<link rel="alternate" hreflang="x-default" href="https://zaf1ro.github.io/p/52ae.html" />
<link rel="alternate" hreflang="zh" href="https://zaf1ro.github.io/p/52ae.html" />




  <link rel="alternate" href="/default" title="Zaf1ro" >




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.jpeg?v=1.1" />



<link rel="canonical" href="https://zaf1ro.github.io/p/52ae.html"/>


<meta name="description" content="1. IntroductionParserä½œä¸ºfront-endçš„ç¬¬äºŒéƒ¨åˆ†, è´Ÿè´£åˆ¤æ–­è¾“å…¥çš„å­—ç¬¦ä¸²æ˜¯å¦ä¸ºåˆæ³•ç¨‹åº, è‹¥ä¸åˆæ³•, åˆ™å‘ç”¨æˆ·å›æŠ¥é”™è¯¯å’Œè¯Šæ–­ä¿¡æ¯. ç»è¿‡scannerçš„å¤„ç†å, parseræ¥æ”¶åˆ°çš„ä¸å…‰æ˜¯ä¸€ä¸ªä¸ªå­—ç¬¦ä¸², è¿˜æœ‰æ¯ä¸ªå­—ç¬¦ä¸²å¯¹åº”çš„è¯ç±». ä¸ºäº†åˆ†æä»»æ„è¯­å¥æ˜¯å¦ç¬¦åˆæœ‰æ•ˆ, éœ€è¦ä¸€ç§å½¢å¼åŒ–æœºåˆ¶æ¥åšå‡ºæ˜ç¡®åˆ¤æ–­, è¿™å°±éœ€è¦å°†source languageé™åˆ¶ä¸ºcontext-free l">
<meta property="og:type" content="article">
<meta property="og:title" content="Parser (1)">
<meta property="og:url" content="https://zaf1ro.github.io/p/52ae.html">
<meta property="og:site_name" content="Zaf1ro">
<meta property="og:description" content="1. IntroductionParserä½œä¸ºfront-endçš„ç¬¬äºŒéƒ¨åˆ†, è´Ÿè´£åˆ¤æ–­è¾“å…¥çš„å­—ç¬¦ä¸²æ˜¯å¦ä¸ºåˆæ³•ç¨‹åº, è‹¥ä¸åˆæ³•, åˆ™å‘ç”¨æˆ·å›æŠ¥é”™è¯¯å’Œè¯Šæ–­ä¿¡æ¯. ç»è¿‡scannerçš„å¤„ç†å, parseræ¥æ”¶åˆ°çš„ä¸å…‰æ˜¯ä¸€ä¸ªä¸ªå­—ç¬¦ä¸², è¿˜æœ‰æ¯ä¸ªå­—ç¬¦ä¸²å¯¹åº”çš„è¯ç±». ä¸ºäº†åˆ†æä»»æ„è¯­å¥æ˜¯å¦ç¬¦åˆæœ‰æ•ˆ, éœ€è¦ä¸€ç§å½¢å¼åŒ–æœºåˆ¶æ¥åšå‡ºæ˜ç¡®åˆ¤æ–­, è¿™å°±éœ€è¦å°†source languageé™åˆ¶ä¸ºcontext-free l">
<meta property="og:locale">
<meta property="og:image" content="https://zaf1ro.github.io/images/Compiler/3-1.png">
<meta property="og:image" content="https://zaf1ro.github.io/images/Compiler/3-2.png">
<meta property="og:image" content="https://zaf1ro.github.io/images/Compiler/3-3.png">
<meta property="og:image" content="https://zaf1ro.github.io/images/Compiler/3-4.png">
<meta property="article:published_time" content="2020-02-11T16:55:10.000Z">
<meta property="article:modified_time" content="2024-08-20T16:43:04.031Z">
<meta property="article:tag" content="Compiler">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zaf1ro.github.io/images/Compiler/3-1.png">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1" />




    <title>
Parser (1) - Zaf1ro
</title>
  <meta name="generator" content="Hexo 6.3.0"></head>

  <body>
  <nav id="sidebar" class="active on-post">
    <div id="third">
      <div id="sidebar-title">
        <h1 id="sidebar-title-text">
            <a href="/." class="logo">Home</a>
        </h1>
      </div>
      <div id="google-search">
  <script async src="https://cse.google.com/cse.js?cx=009060789867951546370:v3hkcobeuh9"></script>
  <div class="gcse-search"></div>
</div>
      
  <div id="toc">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Introduction"><span class="toc-text">1. Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Expressing-Syntax"><span class="toc-text">2. Expressing Syntax</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-Why-Not-Regulaer-Expression"><span class="toc-text">2.1 Why Not Regulaer Expression?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-Context-Free-Grammars"><span class="toc-text">2.2 Context-Free Grammars</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-More-Complex-Examples"><span class="toc-text">2.3 More Complex Examples</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-Encode-Meaning-into-Structure"><span class="toc-text">2.4 Encode Meaning into Structure</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-Discover-a-Derivation-for-an-Input-String"><span class="toc-text">2.5 Discover a Derivation for an Input String</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Top-Down-Parsing"><span class="toc-text">3. Top-Down Parsing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-Transgform-a-Grammar-for-Top-Down-Parsing"><span class="toc-text">3.1 Transgform a Grammar for Top-Down Parsing</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-1-A-Top-Down-Parser-with-Oracular-Choice"><span class="toc-text">3.1.1 A Top-Down Parser with Oracular Choice</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-2-Eliminate-Left-Recursion"><span class="toc-text">3.1.2 Eliminate Left Recursion</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-3-Backtrack-Free-Parsing"><span class="toc-text">3.1.3 Backtrack-Free Parsing</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-4-Left-Factoring-to-Eliminate-Backtracking"><span class="toc-text">3.1.4 Left-Factoring to Eliminate Backtracking</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-Top-Down-Recursive-Descent-Parser"><span class="toc-text">3.2 Top-Down Recursive-Descent Parser</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-Table-Driven-LL-1-Parser"><span class="toc-text">3.3 Table-Driven LL(1) Parser</span></a></li></ol></li></ol>
  </div>

    </div>
  </nav>

    <div id="page">
      <header id="masthead"><div class="site-header-inner">
  
  <button class="nav-mobile-button on-post" id="sidebarCollapse">
  
    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><path d="M24 6h-24v-4h24v4zm0 4h-24v4h24v-4zm0 8h-24v4h24v-4z"/></svg>
  </button>
  
  


  <nav id="nav-top">
    
      
      <ul id="menu-top" class="nav-top-items on-post">
      
        
          <li class="menu-item">
            <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Zaf1ro">
              
              
                Github
              
            </a>
          </li>
        
      </ul>
    
  </nav>
</div>

      </header>
      <div id="content">
        
  <div class="primary">
    
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          Parser (1)
        
      </h1>
      <time class="post-time">
          02/11/20
      </time>
    </header>

    <div class="post-content">
      <h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h2><p>Parserä½œä¸ºfront-endçš„ç¬¬äºŒéƒ¨åˆ†, è´Ÿè´£åˆ¤æ–­è¾“å…¥çš„å­—ç¬¦ä¸²æ˜¯å¦ä¸ºåˆæ³•ç¨‹åº, è‹¥ä¸åˆæ³•, åˆ™å‘ç”¨æˆ·å›æŠ¥é”™è¯¯å’Œè¯Šæ–­ä¿¡æ¯. ç»è¿‡scannerçš„å¤„ç†å, parseræ¥æ”¶åˆ°çš„ä¸å…‰æ˜¯ä¸€ä¸ªä¸ªå­—ç¬¦ä¸², è¿˜æœ‰æ¯ä¸ªå­—ç¬¦ä¸²å¯¹åº”çš„è¯ç±». ä¸ºäº†åˆ†æä»»æ„è¯­å¥æ˜¯å¦ç¬¦åˆæœ‰æ•ˆ, éœ€è¦ä¸€ç§å½¢å¼åŒ–æœºåˆ¶æ¥åšå‡ºæ˜ç¡®åˆ¤æ–­, è¿™å°±éœ€è¦å°†source languageé™åˆ¶ä¸ºcontext-free language(CFG, ä¸Šä¸‹æ–‡æ— å…³è¯­è¨€). å¹¶å­˜åœ¨ä¸¤ç§è§£æCFGçš„ç®—æ³•: LL(1)å’ŒLR(1). å‡è®¾programming languageå®šä¹‰çš„è¯­æ³•ä¸º<strong>G</strong>, è‹¥æŸä¸ªå­—ç¬¦ä¸²<strong>s</strong>å±äº<strong>G</strong>, åˆ™è¯´æ˜å¯ä»¥ç”¨<strong>G</strong>æ¨å¯¼å‡º<strong>s</strong>. Parserçš„ä»»åŠ¡å°±æ˜¯å°†<strong>s</strong>ä¸æ–­æ¨å¯¼ä¸º<strong>G</strong>çš„åˆæ³•è¯­å¥.</p>
<h2 id="2-Expressing-Syntax"><a href="#2-Expressing-Syntax" class="headerlink" title="2. Expressing Syntax"></a>2. Expressing Syntax</h2><p>ä¸ºæ£€æŸ¥è¯­æ³•, éœ€è¦ä¸€ç§ç¬¦å·è¡¨ç¤ºæ³•æ¥æè¿°æè¿°è¯­æ³•. Scannerä½¿ç”¨REæ¥è¡¨ç¤ºæ¥æè¿°åˆæ³•å­—ç¬¦ä¸², ä½†REå¹¶ä¸èƒ½ç”¨äºæè¿°è¯­æ³•.</p>
<h3 id="2-1-Why-Not-Regulaer-Expression"><a href="#2-1-Why-Not-Regulaer-Expression" class="headerlink" title="2.1 Why Not Regulaer Expression?"></a>2.1 Why Not Regulaer Expression?</h3><p>å‡è®¾ç°åœ¨éœ€è¦è¯†åˆ«ç”±å˜é‡, $+, -, \times, &#x2F;$ç»„æˆçš„ä»£æ•°è¡¨è¾¾å¼, å¯å†™ä½œå¦‚ä¸‹RE:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$[a \cdots z]([a \cdots z]|[0 \cdots 9])^&#123;*&#125;((+|-|\times|\div)[a \cdots z]([a \cdots z]|[0 \cdots 9])^&#123;*&#125;)^&#123;*&#125;$</span><br></pre></td></tr></table></figure>
<p>è¯¥REå¯ä»¥åŒ¹é…$a + b \times c$å’Œ$fee \div fie \times \div$. ä½†REæ²¡æœ‰æ³¨æ˜æ“ä½œç¬¦çš„ä¼˜å…ˆçº§, ç†è®ºä¸Š$\times$å’Œ$\div$çš„ä¼˜å…ˆçº§åº”æ¯”$+$å’Œ$-$ä¼˜å…ˆçº§é«˜. å¹¶ä¸”, è¯¥REè¿˜æœªåŠ å…¥æ‹¬å·çš„æ˜¾ç¤º, è¿™é‡Œä½¿ç”¨$\underline{(}$å’Œ$\underline{)}$æ¥è¡¨ç¤ºæ‹¬å·ç¬¦å·. åŠ ä¸Šæ‹¬å·åçš„REå¦‚ä¸‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$(\underline&#123;(&#125;|\epsilon)[a \cdots z]([a \cdots z]|[0 \cdots 9])^&#123;*&#125;((+|-|\times|\div)[a \cdots z]([a \cdots z]|[0 \cdots 9])^&#123;*&#125;)^&#123;*&#125;(\underline&#123;)&#125;|\epsilon)^&#123;*&#125;$</span><br></pre></td></tr></table></figure>
<p>ä¸Šè¿°REå¯ä»¥åŒ¹é…ä»»ä½•æ­£ç¡®çš„å¸¦æ‹¬å·çš„è¡¨è¾¾å¼, ä¾‹å¦‚: $(a + b) \times c$. ä½†å®ƒå¹¶ä¸èƒ½åŒ¹é…è¯­æ³•ä¸Šä¸æ­£ç¡®çš„è¡¨è¾¾å¼, ä¾‹å¦‚: $a + (b \times c$æˆ–$a + b) \times c$, å› ä¸ºREæ— æ³•è®¡æ•°, æ— æ³•åŒ¹é…æˆå¯¹ç»“æ„çš„è¯­æ³•.</p>
<h3 id="2-2-Context-Free-Grammars"><a href="#2-2-Context-Free-Grammars" class="headerlink" title="2.2 Context-Free Grammars"></a>2.2 Context-Free Grammars</h3><p>ä¸€èˆ¬æ¥è¯´, parserä½¿ç”¨CFGæ¥è¡¨ç¤ºè¯­æ³•. å‡è®¾ä¸€ä¸ªCFGåä¸º<strong>G</strong>ä½œä¸ºä¸€ç»„è¯­æ³•è§„åˆ™, æè¿°è¯­å¥æ˜¯å¦‚ä½•å½¢æˆçš„. ä»Gå¯¼å‡ºçš„æ‰€æœ‰è¯­å¥ç»„æˆ<strong>Gå®šä¹‰çš„è¯­è¨€</strong>, è®°ä½œ$L(G)$. ä¸¾ä¸ªè¯­æ³•ä¾‹å­:<br>$$<br>\textit{SheepNoise} \rightarrow \text{baa} \ \textit{SheepNoise} \ | \ \text{baa}<br>$$</p>
<p>ä¸Šè¿°è¯­æ³•å­˜åœ¨ä¸¤æ¡è§„åˆ™, ç§°ä¸ºproduction(äº§ç”Ÿå¼):</p>
<ol>
<li>$\textit{SheepNoise}$å¯æ¨å¯¼å‡º$\text{baa} \ \textit{SheepNoise}$</li>
<li>$\textit{SheepNoise}$å¯æ¨å¯¼å‡º$\text{baa}$</li>
</ol>
<p>å…¶ä¸­, $\textit{SheepNoise}$ä½œä¸ºä¸€ä¸ªnonterminal symbol(éç»ˆæ­¢ç¬¦), å› ä¸ºè¯¥ç¬¦å·å¯æ¨å¯¼å‡ºå…¶ä»–ç¬¦å·, æœ¬æ–‡ç”¨$\textit{æ–œä½“}$æ ·å¼è¡¨ç¤º. $\text{baa}$ä½œä¸ºä¸€ä¸ªterminal symbol(ç»ˆæ­¢ç¬¦), å› ä¸ºè¯¥ç¬¦å·æ— æ³•æ¨å¯¼å‡ºå…¶ä»–ç¬¦å·, æœ¬æ–‡ç”¨$\text{æ­£ä½“}$æ ·å¼è¡¨ç¤º. å½“ä¸€ä¸ªè¯­å¥ä¸­å…¨éƒ¨éƒ½æ˜¯terminal symbolæ—¶, è¯¥è¯­å¥å³ä¸º$L(G)$ä¸­çš„åˆæ³•è¯­å¥. åœ¨scannerçš„è¾“å‡ºå­—ç¬¦ä¸²ä¸­, éœ€è¦é€‰æ‹©ä¸€ä¸ªnonterminal symbol $\alpha$, å¹¶é€‰æ‹©ä¸€ä¸ªè¯­æ³•è§„åˆ™$\alpha \rightarrow \beta$, å°†å­—ç¬¦ä¸²ä¸­çš„$\alpha$æ›¿æ¢ä¸º$\beta$. é‡å¤ä¸Šè¿°è¿‡ç¨‹, ç›´åˆ°å­—ç¬¦ä¸²ä¸­ä¸åŒ…å«nonterminal symbolä¸ºæ­¢. é‡å†™åçš„å­—ç¬¦ä¸²ä¹Ÿå°±æ˜¯$L(G)$ä¸­çš„ä¸€ä¸ªè¯­å¥.<br>CFGåœ¨å½¢å¼ä¸Šæ˜¯ä¸€ä¸ªå››å…ƒç»„$(T, NT, S, P)$, å„å…ƒç´ è§£é‡Šå¦‚ä¸‹:</p>
<ol>
<li>T: terminal symbolé›†åˆ, å¯¹åº”scannerè¿”å›çš„è¯ç±»</li>
<li>NT: nonterminal symbolé›†åˆ, ç”¨äºåœ¨è¡¨è¾¾å¼ä¸­æä¾›æŠ½è±¡å’Œç»“æ„</li>
<li>S: ä¸€ä¸ªç‰¹æ®Šçš„nonterminal symbol, ç§°ä¸ºstart symbolæˆ–goal symbol, ç”¨äºè¡¨ç¤ºè¿›è¡Œæ¨å¯¼çš„å•è¯</li>
<li>P: Gä¸­æ‰€æœ‰è§„åˆ™çš„é›†åˆ, æ¯ä¸ªè§„åˆ™å½¢å¦‚$NT \rightarrow (T \cup NT)^{+}$, å³æ¯æ¬¡æ¨å¯¼éƒ½å°†ä¸€ä¸ªnonterminal symbolæ›¿æ¢ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªè¯­æ³•ç¬¦å·æ„æˆçš„å­—ç¬¦ä¸²</li>
</ol>
<p>å‡è®¾ç¬¦å·ä¸²ä¸º<strong>SheepNoise</strong>, å¯ç”¨è§„åˆ™1æˆ–è§„åˆ™2é‡å†™SheepNoise:</p>
<ol>
<li>ä½¿ç”¨è§„åˆ™2é‡å†™SheepNoiseå, ç¬¦å·ä¸²æ›¿æ¢ä¸º$\text{baa}$, ç”±äºbaaä¸ºterminal symbol, å› æ­¤æ²¡æœ‰å†æ¬¡é‡å†™çš„æœºä¼š</li>
<li>ä½¿ç”¨è§„åˆ™1é‡å†™SheepNoiseå, ç¬¦å·ä¸²æ›¿æ¢ä¸º$\text{baa} \ \textit{SheepNoise}$, è¿™æ—¶ç¬¦å·ä¸²ä¸­ä»æœ‰ä¸€ä¸ªnonterminal symbol, å¯å†æ¬¡ç”¨è§„åˆ™2æ›¿æ¢, å¾—åˆ°$\text{baa baa}$</li>
</ol>
<h3 id="2-3-More-Complex-Examples"><a href="#2-3-More-Complex-Examples" class="headerlink" title="2.3 More Complex Examples"></a>2.3 More Complex Examples</h3><p>ä»¥æ‹¬å·è¡¨è¾¾å¼ä¸ºä¾‹, å…¶è¯­æ³•è§„åˆ™å¦‚ä¸‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 $\textit&#123;Expr&#125; \rightarrow \underline&#123;(&#125; \textit&#123;Expr&#125; \underline&#123;)&#125;$</span><br><span class="line">2      $| \ \textit&#123;Expr&#125; \ \textit&#123;Op&#125; \ \text&#123;name&#125;$</span><br><span class="line">3      $| \ \text&#123;name&#125;$</span><br><span class="line">4 $\textit&#123;Op&#125; \rightarrow +$</span><br><span class="line">5     $| \ -$</span><br><span class="line">6     $| \ \times$</span><br><span class="line">7     $| \ \div$</span><br></pre></td></tr></table></figure>
<p>å‡è®¾è¾“å…¥è¯­å¥ä¸º$(a+b)\times c$, å¯ä½¿ç”¨(2,6,1,2,4,3)çš„è§„åˆ™é¡ºåºæ¥æ¨å¯¼:</p>
<table>
<thead>
<tr>
<th align="center">Rule</th>
<th align="center">Sentential Form</th>
</tr>
</thead>
<tbody><tr>
<td align="center"></td>
<td align="center">$\textit{Expr}$</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">$\textit{Expr Op} \ \text{name}$</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">$\textit{Expr} \times \text{name}$</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">$\underline{(} \textit{Expr} \underline{)} \times \text{name}$</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">$\underline{(} \textit{Expr} + \text{name} \underline{)} \times \text{name}$</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">$\underline{(} \textit{Expr} + \text{name} \underline{)} \times \text{name}$</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">$\underline{(} \text{name} + \text{name} \underline{)} \times \text{name}$</td>
</tr>
</tbody></table>
<p><strong>name</strong>å¹¶ä¸æ˜¯æŸä¸ªå…·ä½“å˜é‡, è€Œè¡¨ç¤ºä¸€ç§è¯ç±», å¯ä»¥è¡¨ç¤ºa, bæˆ–c. ä¸Šè¿°æ¨å¯¼è¿‡ç¨‹ä¹Ÿå¯ä»¥è¡¨ç¤ºä¸ºparse tree:<br><img src="/images/Compiler/3-1.png" alt="Parse Tree for (a+b)Ã—c"></p>
<p>è¿™æ ·ç”Ÿæˆçš„CFGè¯­å¥ä¸å¯èƒ½å¸¦æœ‰å·¦å³ä¸å¹³è¡¡æˆ–åµŒå¥—å…³ç³»é”™è¯¯çš„æ‹¬å·, å› ä¸ºè§„åˆ™1ä¼šç”Ÿæˆå·¦å³å¯¹ç§°çš„æ‹¬å·. åœ¨$(a+b)\times c$æ¨å¯¼è¿‡ç¨‹ä¸­, æ¯ä¸€æ¬¡æ¨å¯¼éƒ½æ ¹æ®æœ€å³ç«¯çš„nonterminal symbol, ç§°ä¸ºrightmost derivation(æœ€å³æ¨å¯¼); ä¹Ÿå¯ä»¥æ ¹æ®æœ€å·¦ä¾§nonterminal symbolæ¥æ¨å¯¼, ç§°ä¸ºleftmost derivation(æœ€å·¦æ¨å¯¼):</p>
<table>
<thead>
<tr>
<th align="center">Rule</th>
<th align="center">Sentential Form</th>
</tr>
</thead>
<tbody><tr>
<td align="center"></td>
<td align="center">$\textit{Expr}$</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">$\textit{Expr Op} \ \text{name}$</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">$\underline{(} \textit{Expr} \underline{)} \ \textit{Op} \ \text{name}$</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">$\underline{(} \textit{Expr Op} \ \text{name} \underline{)} \ \textit{Op} \ \text{name}$</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">$\underline{(} \text{name} \ \textit{Op} \ \text{name} \underline{)} \ \textit{Op} \ \text{name}$</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">$\underline{(} \text{name} + \text{name} \underline{)} \ \textit{Op} \ \text{name}$</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">$\underline{(} \text{name} + \text{name} \underline{)} \times \text{name}$</td>
</tr>
</tbody></table>
<p>æ— è®ºæ˜¯æœ€å·¦è¿˜æ˜¯æœ€å³, éƒ½æ˜¯ä½¿ç”¨åŒä¸€ç»„è§„åˆ™. å¯¹æœ€å³ç«¯(æˆ–æœ€å·¦ç«¯)nonterminal symbolçš„æ¨å¯¼å­˜åœ¨å¤šç§é‡å†™ç»“æœæ—¶, ç§°ä¸º<strong>ambiguous grammer</strong>(äºŒä¹‰æ€§è¯­æ³•). äºŒä¹‰æ€§è¯­æ³•ä¼šç”Ÿæˆå¤šä¸ªparse tree, ä¹Ÿå°±å¯¼è‡´compileræ— æ³•è‚¯å®šä¸€ä¸ªè¯­å¥çš„è¯­ä¹‰, ä¹Ÿæ— æ³•å°†å…¶è½¬æ¢ä¸ºä¸€ä¸ªç¡®å®šçš„ä»£ç åºåˆ—. ä¾‹å¦‚:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 $\textit&#123;Statement&#125; \rightarrow \text&#123;if&#125; \ \textit&#123;Expr&#125; \ \text&#123;then&#125; \ \textit&#123;Statement&#125; \ \text&#123;else&#125; \ \textit&#123;Statement&#125;$</span><br><span class="line">2         $| \ \text&#123;if&#125; \ \textit&#123;Expr&#125; \ \text&#123;then&#125; \ \textit&#123;Statement&#125;$</span><br><span class="line">3         $| \ \textit&#123;Assignment&#125;$</span><br></pre></td></tr></table></figure>
<p>å‡è®¾è¾“å…¥ä»£ç ä¸º$\text{if} \ \textit{Expr}_1 \ \text{then} \ \text{if} \ \textit{Expr}_2 \ \text{then} \ \textit{Assignment}_1 \ \text{else} \ \textit{Assignment}_2$, æœ€å³æ¨å¯¼æœ‰ä¸¤ç§ç»“æœ: </p>
<ol>
<li><p>å°†$\textit{Assignment}_2$ä¸å†…å±‚çš„$\text{if}$é…å¯¹, å½“$\textit{Expr}_1$ä¸ºtrueä¸”$\textit{Expr}_2$ä¸ºfalseæ—¶æ‰§è¡Œ$\textit{Assignment}_2$<br><img src="/images/Compiler/3-2.png" alt="rightmost derivation 1"></p>
</li>
<li><p>å°†$\textit{Assignment}_2$ä¸å¤–å±‚çš„$\text{if}$é…å¯¹, å½“$\textit{Expr}_1$ä¸ºfalseæ—¶æ‰§è¡Œ$\textit{Assignment}_2$<br><img src="/images/Compiler/3-3.png" alt="rightmost derivation 2"></p>
</li>
</ol>
<p>ä¸ºæ¶ˆé™¤è¿™ç§äºŒä¹‰æ€§, å¯å¼•å…¥ä¸€æ¡æ–°çš„è§„åˆ™æ¥è§„å®šå“ªä¸ªifæ§åˆ¶ç‰¹å®šçš„elseå­å¥:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 $\textit&#123;Statement&#125; \rightarrow \text&#123;if&#125; \ \textit&#123;Expr&#125; \ \text&#123;then&#125; \ \textit&#123;Statement&#125;$</span><br><span class="line">2         $| \ \text&#123;if&#125; \ \textit&#123;Expr&#125; \ \text&#123;then&#125; \ \textit&#123;WithElse&#125; \ \text&#123;else&#125; \ \textit&#123;Statement&#125;$</span><br><span class="line">3         $| \ \textit&#123;Assignment&#125;$</span><br><span class="line">4 $\textit&#123;WithElse&#125; \rightarrow \text&#123;if&#125; \ \textit&#123;Expr&#125; \ \text&#123;then&#125; \ \textit&#123;WithElse&#125; \ \text&#123;else&#125; \ \textit&#123;WithElse&#125;$</span><br><span class="line">5         $| \ \textit&#123;Assignment&#125;$ </span><br></pre></td></tr></table></figure>
<p>ä¸Šè¿°è¯­æ³•é™åˆ¶äº†$\text{then}$åçš„è¯­æ³•ç»“æ„, ç¡®ä¿æ¯ä¸ª$\text{else}$éƒ½åŒ¹é…åˆ°å”¯ä¸€$\text{if}$. ä¹Ÿæœ‰ä¸€äº›è¯­è¨€é‡æ–°è®¾è®¡äº†<strong>if-then-else</strong>ç»“æ„, å¼•å…¥<strong>elseif</strong>å’Œ<strong>endif</strong>.</p>
<h3 id="2-4-Encode-Meaning-into-Structure"><a href="#2-4-Encode-Meaning-into-Structure" class="headerlink" title="2.4 Encode Meaning into Structure"></a>2.4 Encode Meaning into Structure</h3><p>Parserä½¿ç”¨çš„è¯­æ³•ç»“æ„ä¸è¯­è¨€çš„è¯­ä¹‰æœ‰ç›´æ¥è”ç³», ä»¥$a + b \times c$ä¸ºä¾‹, å…¶æœ€å³æ¨å¯¼çš„parse treeä¸º:<br><img src="/images/Compiler/3-4.png" alt="parse tree of a+bxc"></p>
<p>è¡¨è¾¾å¼çš„æ±‚å€¼å¯ä»¥çœ‹ä½œæ˜¯parse treeçš„ååºéå†, å…ˆè®¡ç®—$a+b$, åœ¨å°†å…¶ç»“æœä¹˜ä»¥c. ä¸ºçº æ­£è¿ç®—ä¼˜å…ˆçº§çš„é—®é¢˜, å¯åœ¨è¯­æ³•ä¸­å¤šæ·»åŠ å‡ ä¸ªå±‚æ¬¡, ä¼˜å…ˆå¤„ç†$()$, ç„¶åå¤„ç†$\times \div$, æœ€åå¤„ç†$+-$. è¡¨è¾¾å¼è¯­æ³•å¦‚ä¸‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0 $\textit&#123;Goal&#125; \rightarrow \textit&#123;Expr&#125;$</span><br><span class="line">1 $\textit&#123;Expr&#125; \rightarrow \textit&#123;Expr&#125; + \textit&#123;Term&#125;$</span><br><span class="line">2      $| \ \textit&#123;Expr&#125; - \textit&#123;Term&#125;$</span><br><span class="line">3      $| \ \textit&#123;Term&#125;$</span><br><span class="line">4 $\textit&#123;Term&#125; \rightarrow \textit&#123;Term&#125; \times \textit&#123;Factor&#125;$</span><br><span class="line">5      $| \ \textit&#123;Term&#125; \div \textit&#123;Factor&#125;$</span><br><span class="line">6      $| \ \textit&#123;Factor&#125;$</span><br><span class="line">7 $\textit&#123;Factor&#125; \rightarrow \underline&#123;(&#125; \textit&#123;Expr&#125; \underline&#123;)&#125;$</span><br><span class="line">8      $| \ \text&#123;num&#125;$</span><br><span class="line">9      $| \ \text&#123;name&#125;$</span><br></pre></td></tr></table></figure>

<h3 id="2-5-Discover-a-Derivation-for-an-Input-String"><a href="#2-5-Discover-a-Derivation-for-an-Input-String" class="headerlink" title="2.5 Discover a Derivation for an Input String"></a>2.5 Discover a Derivation for an Input String</h3><p>ä¸Šè¿°æ¨å¯¼ç”¨CFGæ¨å¯¼å‡º$L(G)$ä¸­çš„è¯­å¥, ä¸æ­¤ç›¸å, compilerå¿…é¡»ä¸ºè¾“å…¥å­—ç¬¦ä¸²ç»™å‡ºä¸€ä¸ªæ¨å¯¼, è¿™ä¸€è¿‡ç¨‹è¢«ç§°ä¸ºparsing(è¯­æ³•åˆ†æ). Scannerä¼šä¸ºè¾“å…¥å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå•è¯æ ‡æ³¨<strong>è¯ç±»</strong>, ä¾‹å¦‚: $a + b \times c$, scannerä¼šè¾“å‡º$\langle name, a \rangle + \langle name, b \rangle \times \langle name, c \rangle$. Parse treeçš„æ ¹èŠ‚ç‚¹æ˜¯å·²çŸ¥çš„, è€Œparse treeä¸­çš„å¶å­èŠ‚ç‚¹å°±æ˜¯æ¯ä¸ªè¾“å…¥å•è¯, parserè¦åšçš„å°±æ˜¯æ‰¾åˆ°å¶å­èŠ‚ç‚¹å’Œæ ¹èŠ‚ç‚¹ä¹‹é—´çš„è¯­æ³•å…³è”, ä»¥ä¸‹æ˜¯ä¸¤ç§æ„å»ºparse treeçš„æ–¹æ³•:</p>
<ol>
<li>Top-down parser(è‡ªé¡¶å‘ä¸‹è¯­æ³•åˆ†æå™¨): ä»æ ¹èŠ‚ç‚¹å¼€å§‹æ„é€ parse tree, å¹¶å‘å¶å­èŠ‚ç‚¹æ–¹å‘å¢é•¿. æ¯ä¸€æ­¥ä¼šä»æ ‘çš„ä¸‹è¾¹ç¼˜(å½“å‰å¶å­èŠ‚ç‚¹)é€‰æ‹©ä¸€ä¸ªnonterminal symbol, å¹¶æ ¹æ®è¯­æ³•è§„åˆ™å±•å¼€è¯¥èŠ‚ç‚¹, å­æ ‘è¡¨ç¤ºnonterminal symbolçš„å±•å¼€å¼.</li>
<li>Bottom-up parser(è‡ªåº•å‘ä¸Šè¯­æ³•åˆ†æå™¨): ä»å¶å­èŠ‚ç‚¹å¼€å§‹æ„é€ parse tree, å¹¶å‘æ ¹èŠ‚ç‚¹çš„æ–¹å‘å¢é•¿. æ¯ä¸€æ­¥éƒ½ä»æ ‘çš„ä¸Šè¾¹ç¼˜(å½“å‰æ ¹èŠ‚ç‚¹)é€‰æ‹©ä¸€ä¸ªè¿ç»­çš„å­ä¸², æ ¹æ®è¯­æ³•è§„åˆ™å½’çº³è¯¥å­ä¸², çˆ¶èŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªnonterminal symbol.</li>
</ol>
<h2 id="3-Top-Down-Parsing"><a href="#3-Top-Down-Parsing" class="headerlink" title="3. Top-Down Parsing"></a>3. Top-Down Parsing</h2><p>ä»parse treeçš„è§’åº¦æ¥çœ‹, top-down parserä»æ ¹èŠ‚ç‚¹å¼€å§‹, é€‰æ‹©ä¸€ä¸ªnonterminal symbolå¹¶ä½¿ç”¨åˆé€‚çš„productioné‡å†™, ç›´åˆ°å‘ç”Ÿå…¶ä¸­ä¸€ç§æƒ…å†µ:</p>
<ol>
<li>æ‰€æœ‰å¶å­èŠ‚ç‚¹éƒ½ä¸ºterminal symbol, ä¸”è¾“å…¥æµå·²è€—å°½</li>
<li>parse treeä¸­å¶å­èŠ‚ç‚¹ä¸è¾“å…¥æµä¸åŒ¹é…</li>
</ol>
<p>ç¬¬ä¸€ç§æƒ…å†µè¯´æ˜è¯­æ³•åˆ†ææˆåŠŸ; ç¬¬äºŒç§æƒ…å†µåˆ™å­˜åœ¨ä¸¤ç§æƒ…å†µ: è¯­æ³•åˆ†æä¸­é€‰æ‹©äº†é”™è¯¯çš„production, è¿™æ—¶å¯å›æº¯å¹¶é€‰æ‹©ä¸åŒçš„production; ä¹Ÿå¯èƒ½å› ä¸ºè¾“å…¥æµä¸æ˜¯æœ‰æ•ˆè¯­å¥, éœ€è¦å‘ç”¨æˆ·æŠ¥å‘Šé”™è¯¯. Top-down parserä¹‹æ‰€ä»¥èƒ½é«˜æ•ˆåœ°è¿è¡Œ, å¾—ç›ŠäºCFGä¸éœ€è¦å›æº¯ä¹Ÿå¯å®Œæˆè¯­æ³•åˆ†æ. é€šè¿‡ä¸€äº›è½¬æ¢, å¯å°†ä»»æ„è¯­æ³•è½¬æ¢ä¸ºé€‚å½“çš„å½¢å¼æ¥è¿›è¡Œæ— å›æº¯çš„è‡ªé¡¶å‘ä¸‹è¯­æ³•åˆ†æ. ä»¥ä¸‹æ˜¯top-down parserä½¿ç”¨æœ€å·¦æ¨å¯¼çš„å…·ä½“ç®—æ³•:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root $\leftarrow$ node for the start symbol, S ;</span><br><span class="line">focus $\leftarrow$ root;</span><br><span class="line">push(null);</span><br><span class="line">word $\leftarrow$ NextWord( );</span><br><span class="line">while (true) do;</span><br><span class="line">  if (focus is a nonterminal)</span><br><span class="line">    pick rule to expand focus ($A \rightarrow &#123;\beta&#125;_1, &#123;\beta&#125;_2, \ldots, &#123;\beta&#125;_n$);</span><br><span class="line">    build nodes for $&#123;\beta&#125;_1, &#123;\beta&#125;_2, \ldots, &#123;\beta&#125;_n$ as children of focus;</span><br><span class="line">    push($&#123;\beta&#125;_n, &#123;\beta&#125;_&#123;n-1&#125;, \ldots, &#123;\beta&#125;_2$);</span><br><span class="line">    focus $\leftarrow$ $&#123;\beta&#125;_1$;</span><br><span class="line">  end;</span><br><span class="line">  else if (word matches focus)</span><br><span class="line">    word $\leftarrow$ NextWord( );</span><br><span class="line">    focus $\leftarrow$ pop()</span><br><span class="line">  end;</span><br><span class="line">  else if (word = eof and focus = null)</span><br><span class="line">    accept the input and return root;</span><br><span class="line">  else </span><br><span class="line">    backtrack;</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>
<p>è¯¥parserçš„ä¸»è¦éƒ¨åˆ†æ˜¯whileå¾ªç¯, éµå¾ªå‰åºéå†è§„åˆ™, ä¸æ–­å¯¹parse treeä¸­çš„æœ€å·¦å¶å­èŠ‚ç‚¹è¿›è¡Œåˆ¤æ–­:</p>
<ol>
<li>è‹¥æœ€å·¦å¶å­èŠ‚ç‚¹ä¸ºnonterminal symbol, åˆ™æ ¹æ®è¯­æ³•è§„åˆ™é€‰æ‹©ä¸€ä¸ªproductionå±•å¼€</li>
<li>è‹¥æœ€å·¦å¶å­èŠ‚ç‚¹ä¸ºterminal symbol, åˆ™ä¸è¾“å…¥æµä¸­çš„å•è¯åŒ¹é…:</li>
<li>åŒ¹é…æˆåŠŸ: ç»§ç»­åˆ¤æ–­ä¸‹ä¸€ä¸ªå¶å­èŠ‚ç‚¹</li>
<li>åŒ¹é…å¤±è´¥: å‘ä¸Šå›æº¯, å°è¯•ä½¿ç”¨å…¶ä»–production; è‹¥è§„åˆ™éƒ½è¯•è¿‡, åˆ™å†å‘ä¸Šå›æº¯.</li>
</ol>
<h3 id="3-1-Transgform-a-Grammar-for-Top-Down-Parsing"><a href="#3-1-Transgform-a-Grammar-for-Top-Down-Parsing" class="headerlink" title="3.1 Transgform a Grammar for Top-Down Parsing"></a>3.1 Transgform a Grammar for Top-Down Parsing</h3><p>Top-down parserçš„æ•ˆç‡ä¾èµ–äºæ˜¯å¦æ­£ç¡®é€‰æ‹©production, å¦‚æœparseræ€»æ˜¯èƒ½é€‰æ‹©æ­£ç¡®çš„production, åˆ™ååˆ†é«˜æ•ˆ. ä¸€æ—¦åšå‡ºé”™è¯¯é€‰æ‹©, åˆ™æ•ˆç‡ç›´çº¿ä¸‹é™. ç”šè‡³åœ¨æŸäº›æƒ…å†µä¸‹, parserä¼šé™·å…¥æ­»å¾ªç¯è€Œæ— æ³•ç»ˆæ­¢. </p>
<h4 id="3-1-1-A-Top-Down-Parser-with-Oracular-Choice"><a href="#3-1-1-A-Top-Down-Parser-with-Oracular-Choice" class="headerlink" title="3.1.1 A Top-Down Parser with Oracular Choice"></a>3.1.1 A Top-Down Parser with Oracular Choice</h4><p>ä»¥$a+b \times c$ä¸ºä¾‹, å‡è®¾parseræ¯æ¬¡éƒ½èƒ½é€‰æ‹©æ­£ç¡®çš„production, åˆ™è¯­æ³•åˆ†æè¿‡ç¨‹å¦‚ä¸‹:</p>
<table>
<thead>
<tr>
<th align="center">Rule</th>
<th align="center">Sentential Form</th>
<th align="center">Input</th>
</tr>
</thead>
<tbody><tr>
<td align="center"></td>
<td align="center">$\textit{Expr}$</td>
<td align="center">$\uparrow \text{name} + \text{name} \times \text{name}$</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">$\textit{Expr} + \textit{Term}$</td>
<td align="center">$\uparrow \text{name} + \text{name} \times \text{name}$</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">$\textit{Term} + \textit{Term}$</td>
<td align="center">$\uparrow \text{name} + \text{name} \times \text{name}$</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">$\textit{Factor} + \textit{Term}$</td>
<td align="center">$\uparrow \text{name} + \text{name} \times \text{name}$</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">$\text{name} + \textit{Term}$</td>
<td align="center">$\uparrow \text{name} + \text{name} \times \text{name}$</td>
</tr>
<tr>
<td align="center">$\rightarrow$</td>
<td align="center">$\text{name} + \textit{Term}$</td>
<td align="center">$\text{name} \uparrow + \ \text{name} \times \text{name}$</td>
</tr>
<tr>
<td align="center">$\rightarrow$</td>
<td align="center">$\text{name} + \textit{Term}$</td>
<td align="center">$\text{name} \ + \uparrow \text{name} \times \text{name}$</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">$\text{name} + \textit{Term} \times \textit{Factor}$</td>
<td align="center">$\text{name} \ + \uparrow \text{name} \times \text{name}$</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">$\text{name} + \textit{Factor} \times \textit{Factor}$</td>
<td align="center">$\text{name} \ + \uparrow \text{name} \times \text{name}$</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">$\text{name} + \text{name} \times \textit{Factor}$</td>
<td align="center">$\text{name} \ + \uparrow \text{name} \times \text{name}$</td>
</tr>
<tr>
<td align="center">$\rightarrow$</td>
<td align="center">$\text{name} + \text{name} \times \textit{Factor}$</td>
<td align="center">$\text{name} + \text{name} \uparrow \times \ \text{name}$</td>
</tr>
<tr>
<td align="center">$\rightarrow$</td>
<td align="center">$\text{name} + \text{name} \times \textit{Factor}$</td>
<td align="center">$\text{name} + \text{name} \ \times \uparrow \text{name}$</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">$\text{name} + \text{name} \times \text{name}$</td>
<td align="center">$\text{name} + \text{name} \ \times \uparrow \text{name}$</td>
</tr>
<tr>
<td align="center">$\rightarrow$</td>
<td align="center">$\text{name} + \text{name} \times \text{name}$</td>
<td align="center">$\text{name} + \text{name} \times \text{name} \uparrow$</td>
</tr>
</tbody></table>
<p>å…¶ä¸­, Inputä¸­çš„$\uparrow$è¡¨ç¤ºparserå½“å‰æ‰€å¤„çš„ä½ç½®, Ruleä¸­çš„$\rightarrow$è¡¨ç¤ºparserçš„ä½ç½®å‰è¿›ä¸€ä½. åœ¨productionå…¨éƒ¨é€‰æ‹©æ­£ç¡®çš„æƒ…å†µä¸‹, parserèŠ±è´¹çš„æ—¶é—´ä¸è¾“å…¥æµé•¿åº¦æˆæ­£æ¯”. </p>
<h4 id="3-1-2-Eliminate-Left-Recursion"><a href="#3-1-2-Eliminate-Left-Recursion" class="headerlink" title="3.1.2 Eliminate Left Recursion"></a>3.1.2 Eliminate Left Recursion</h4><p>ä¸Šè¿°è¯­æ³•åˆ†æè¿‡ç¨‹ä¸­, æ¯ä¸€æ­¥éƒ½é€‰æ‹©äº†æ­£ç¡®çš„production, ä¾‹å¦‚: ç¬¬ä¸€æ­¥ä¸­ä½¿ç”¨äº†<strong>Rule 1</strong>, $\textit{Expr} \rightarrow \textit{Expr} + \textit{Term}$, è€Œç¬¬äºŒæ­¥ä½¿ç”¨äº†<strong>Rule 3</strong>, $\textit{Expr} \rightarrow \textit{Term}$, è¿™æ ·å¾ˆéš¾ç”Ÿæˆä¸€ä¸ªå…·æœ‰ä¸€è‡´æ€§çš„parser. å‡è®¾parseræ€»æ˜¯æŒ‰ç…§ruleç¼–å·ä»å°åˆ°å¤§é€‰æ‹©production, è¯­æ³•åˆ†æå¦‚ä¸‹:</p>
<table>
<thead>
<tr>
<th align="center">Rule</th>
<th align="center">Sentential Form</th>
<th align="center">Input</th>
</tr>
</thead>
<tbody><tr>
<td align="center"></td>
<td align="center">$\textit{Expr}$</td>
<td align="center">$\uparrow \text{name} + \text{name} \times \text{name}$</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">$\textit{Expr} + \textit{Term}$</td>
<td align="center">$\uparrow \text{name} + \text{name} \times \text{name}$</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">$\textit{Expr} + \textit{Term} + \textit{Term}$</td>
<td align="center">$\uparrow \text{name} + \text{name} \times \text{name}$</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">$\ldots$</td>
<td align="center">$\uparrow \text{name} + \text{name} \times \text{name}$</td>
</tr>
</tbody></table>
<p>ä¹‹æ‰€ä»¥å‡ºç°è¿™ç§é—®é¢˜, å› ä¸ºè¯­æ³•è§„åˆ™ä¸­å­˜åœ¨<strong>ç›´æ¥å·¦é€’å½’</strong>, ä¹Ÿå°±æ˜¯è¯´, nonterminal symbolæ¨å¯¼å‡ºçš„productionä¸­ç¬¬ä¸€ä¸ªç¬¦å·ä¸ºè‡ªèº«, æœ€å·¦æ¨å¯¼ä¼šä¸æ–­è‡ªèº«å¾ªç¯. å¯ä½¿ç”¨<strong>å³é€’å½’</strong>é‡æ–°è¡¨ç¤º. ä»¥ä¸‹é¢è¯­æ³•ä¸ºä¾‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$\textit&#123;Fee&#125; \rightarrow \textit&#123;Fee&#125; \ \alpha$</span><br><span class="line">    $| \ \beta$</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨å³é€’å½’é‡å†™å:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$\textit&#123;Fee&#125; \rightarrow \beta \ \textit&#123;Fee&#x27;&#125;$</span><br><span class="line">$\textit&#123;Fee&#x27;&#125; \rightarrow \alpha \ \textit&#123;Fee&#x27;&#125;$</span><br><span class="line">     $| \ \epsilon$</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œå¼•å…¥äº†ä¸€ä¸ªæ–°çš„nonterminal symbol, åä¸º$\textit{Fee&#39;}$, ä¸ä»…å°†é€’å½’è½¬ç§»åˆ°$\textit{Fee}&#39;$ä¸Š, è¿˜æ·»åŠ äº†æ–°è¯­æ³•è§„åˆ™$\textit{Fee}&#39; \rightarrow \epsilon$. å…¶ä¸­$epsilon$è¡¨ç¤ºç©ºä¸², parseråœ¨é‡åˆ°$\epsilon$åä¼šç›´æ¥å‰ç§»åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹. ç®—æœ¯è¿ç®—ç¬¦çš„è¯­æ³•è§„åˆ™ä½¿ç”¨å³é€’å½’é‡å†™åå¦‚ä¸‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0  $\textit&#123;Goal&#125; \rightarrow \textit&#123;Expr&#125;$</span><br><span class="line">1  $\textit&#123;Expr&#125; \rightarrow \textit&#123;Term&#125; \ \textit&#123;Expr&#x27;&#125;$</span><br><span class="line">2  $\textit&#123;Expr&#x27;&#125; \rightarrow + \ \textit&#123;Term&#125; \ \textit&#123;Expr&#x27;&#125;$</span><br><span class="line">3  $\textit&#123;Expr&#x27;&#125; \rightarrow - \ \textit&#123;Term&#125; \ \textit&#123;Expr&#x27;&#125;$</span><br><span class="line">4       $| \ \epsilon$</span><br><span class="line">5  $\textit&#123;Term&#125; \rightarrow \textit&#123;Factor&#125; \ \textit&#123;Term&#x27;&#125;$</span><br><span class="line">6  $\textit&#123;Term&#x27;&#125; \rightarrow \times \ \textit&#123;Factor&#125; \ \textit&#123;Term&#x27;&#125;$</span><br><span class="line">7  $\textit&#123;Term&#x27;&#125; \rightarrow \div \ \textit&#123;Factor&#125; \ \textit&#123;Term&#x27;&#125;$</span><br><span class="line">8       $| \ \epsilon$</span><br><span class="line">9  $\textit&#123;Factor&#125; \rightarrow \underline&#123;(&#125; \ \textit&#123;Expr&#125; \ \underline&#123;)&#125;$</span><br><span class="line">10      $| \ \text&#123;num&#125;$</span><br><span class="line">11      $| \ \text&#123;name&#125;$</span><br></pre></td></tr></table></figure>
<p>é‡å†™åçš„è¯­æ³•è§„åˆ™é¿å…äº†ç›´æ¥å·¦é€’å½’, ä½†å¯¹äºæ‹¥æœ‰å¤§é‡è§„åˆ™çš„è¯­æ³•æ¥è¯´, æ— æ³•é€šè¿‡æ‰‹åŠ¨é‡å†™è¯­æ³•æ¥é¿å…<strong>é—´æ¥å·¦é€’å½’</strong>, ä¾‹å¦‚: $\alpha \rightarrow \beta, \beta \rightarrow \gamma, \gamma \rightarrow \alpha\delta$, ç›¸å½“äº$\alpha \rightarrow \alpha\delta$. å› æ­¤éœ€è¦ä¸€ç§ç³»ç»ŸåŒ–çš„æ–¹æ³•æ¶ˆé™¤è¯­æ³•ä¸­æ‰€æœ‰å·¦é€’å½’: forward substitution, ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">impose an order on the nonterminals,$A_1, A_2, \cdots, A_n$</span><br><span class="line">for i $\leftarrow$ 1 to n do;</span><br><span class="line">  for j $\leftarrow$ 1 to i - 1 do;</span><br><span class="line">    if $\exists$ a production $A_i \rightarrow A_j\gamma$</span><br><span class="line">      replace $A_i \rightarrow A_j\gamma$ with one or more productions that expand $A_j$</span><br><span class="line">  end;</span><br><span class="line">  rewrite the productions to eliminate any direct left recursion on $A_i$</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>
<p>è¯¥ç®—æ³•ä¸ºæ‰€æœ‰nonterminal symbolè§„å®šäº†ä¸€ä¸ªæ¨å¯¼é¡ºåº, å¹¶ä»å¤–å±‚å¾ªç¯å¼€å§‹éå†, å†…å­˜å¾ªç¯åˆ™å¯»æ‰¾ä»»ä½•æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„production: å°†$A_i$æ‰©å±•ä¸º$A_j$å¼€å¤´çš„å³ä¾§å¥å‹. å‡è®¾$A_i \rightarrow A_j\gamma$, ä¸”$A_j \rightarrow {\beta}_1|{\beta}_2|\cdots|{\beta}_k$, åˆ™å°†$A_i \rightarrow A_j\gamma$æ›¿æ¢ä¸º$A_i \rightarrow {\beta}_1|{\beta}_2|\cdots|{\beta}_k \gamma$. è¿™ä¸ªè¿‡ç¨‹ä¼šå°†<strong>é—´æ¥å·¦é€’å½’</strong>è½¬æ¢ä¸º<strong>ç›´æ¥å·¦é€’å½’</strong>. å†…å±‚å¾ªç¯å, $A_i$ç›¸å…³çš„æ‰€æœ‰é—´æ¥å·¦é€’å½’éƒ½å˜ä¸ºç›´æ¥å·¦é€’å½’, ç”¨å³é€’å½’æ¶ˆé™¤å³å¯.</p>
<h4 id="3-1-3-Backtrack-Free-Parsing"><a href="#3-1-3-Backtrack-Free-Parsing" class="headerlink" title="3.1.3 Backtrack-Free Parsing"></a>3.1.3 Backtrack-Free Parsing</h4><p>ä¸ºè®©parseræ¯æ¬¡éƒ½é€‰æ‹©æ­£ç¡®çš„production, é™¤äº†å½“å‰å…³æ³¨çš„ç¬¦å·å¤–, éœ€è¦è€ƒè™‘ä¸‹ä¸€ä¸ªè¾“å…¥ç¬¦å·, ç§°ä¸ºlookahead symbol(å‰ç»ç¬¦å·). é€šè¿‡lookahead symbol, parserå¯ä»¥æ¶ˆé™¤å³é€’å½’è¡¨è¾¾å¼é€‰æ‹©é€ æˆçš„ä¸ç¡®å®šæ€§, ä¹Ÿå¯ä»¥è¯´æ˜¯æ— å›æº¯çš„. ä»å®šä¹‰ä¸Šæ¥è¯´, å¯¹äºæ¯ä¸ªè¯­æ³•ç¬¦å·$\alpha$, å®šä¹‰ä¸€ä¸ªé›†åˆ$\text{FIRST}(\alpha)$: ä»$\alpha$æ¨å¯¼å‡ºçš„å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªterminal symbolçš„é›†åˆ. $\text{FIRST}$çš„å®šä¹‰åŸŸä¸º$\text{T} \cup \text{NT} \cup \{\epsilon, \text{eof}\}$, å€¼åŸŸä¸º$\text{T} \cup \{\epsilon, \text{eof}\}$.</p>
<p>ä»¥ç®—æ³•è¿ç®—ç¬¦ä¸ºä¾‹, terminal symbol, $epsilon$å’Œeofçš„FIRSTé›†åˆä¹Ÿå°±æ˜¯ç¬¦å·æœ¬èº«:</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">num</th>
<th align="center">name</th>
<th align="center">+</th>
<th align="center">-</th>
<th align="center">$\times$</th>
<th align="center">$\div$</th>
<th align="center">$\underline{(}$</th>
<th align="center">$\underline{)}$</th>
<th align="center">eof</th>
<th align="center">$\epsilon$</th>
</tr>
</thead>
<tbody><tr>
<td align="center">FIRST</td>
<td align="center">num</td>
<td align="center">name</td>
<td align="center">+</td>
<td align="center">-</td>
<td align="center">$\times$</td>
<td align="center">$\div$</td>
<td align="center">$\underline{(}$</td>
<td align="center">$\underline{)}$</td>
<td align="center">eof</td>
<td align="center">$\epsilon$</td>
</tr>
</tbody></table>
<p>å¯¹äºnonterminal symbol, å…¶FIRSTé›†åˆå¦‚ä¸‹:</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">Expr</th>
<th align="center">Expr&#39;</th>
<th align="center">Term</th>
<th align="center">Term&#39;</th>
<th align="center">Factor</th>
</tr>
</thead>
<tbody><tr>
<td align="center">FIRST</td>
<td align="center">$\underline{(}, name, num$</td>
<td align="center">$+, -, \epsilon$</td>
<td align="center">$\underline{(}, name, num$</td>
<td align="center">$\times, \div, \epsilon$</td>
<td align="center">$\underline{(}, name, num$</td>
</tr>
</tbody></table>
<p>æ„å»ºnonterminal symbolçš„FIRSTé›†åˆçš„ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">for each $\alpha \in$ (T $\cup$ eof $\cup \epsilon$) do;</span><br><span class="line">  $\text&#123;FIRST&#125;(\alpha) \leftarrow \alpha$;</span><br><span class="line">end;</span><br><span class="line">for each A âˆˆ N T do;</span><br><span class="line">  $\text&#123;FIRST&#125;(A) \leftarrow \phi$;</span><br><span class="line">end;</span><br><span class="line"></span><br><span class="line">while ($\text&#123;FIRST&#125;$ sets are still changing) do;</span><br><span class="line">  for each $p \in P$, where $p$ has the form $A \rightarrow \beta$ do;</span><br><span class="line">    if $\beta$ is $&#123;\beta&#125;_1 &#123;\beta&#125;_2 \ldots &#123;\beta&#125;_k$, where $&#123;\beta&#125;_i \in \text&#123;T&#125; \cup \text&#123;NT&#125;$</span><br><span class="line">      rhs $\leftarrow \text&#123;FIRST&#125;(&#123;\beta&#125;_1) âˆ’ &#123;\epsilon&#125;$;</span><br><span class="line">      i $\leftarrow$ 1;</span><br><span class="line">      while (i $\leq$ k-1 and $\epsilon \in \text&#123;FIRST&#125;(&#123;\beta&#125;_i)$) do;</span><br><span class="line">        rhs $\leftarrow$ rhs $\cup$ ($\text&#123;FIRST&#125;(&#123;\beta&#125;_&#123;i+1&#125;) âˆ’ &#123;\epsilon&#125;$);</span><br><span class="line">        i $\leftarrow$ i + 1;</span><br><span class="line">      end;</span><br><span class="line">    end;</span><br><span class="line">    if i = k and $\epsilon \in \text&#123;FIRST&#125;(&#123;\beta&#125;_k)$</span><br><span class="line">      rhs $\leftarrow$ rhs $\cup \ \epsilon$;</span><br><span class="line">    $\text&#123;FIRST&#125;$(A) â† $\text&#123;FIRST&#125;$(A) $\cup$ rhs;</span><br><span class="line">  end;</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>
<p>å¯¹äºæ¯ä¸ªproduction $A \rightarrow \beta$æ¥è¯´, $\beta$å¯ä»¥è¡¨ç¤ºæˆå¤šä¸ªç¬¦å·çš„è¿æ¥, ä¹Ÿå°±æ˜¯${\beta}_1 {\beta}_2 \ldots {\beta}_k$, å…¶FIRSTé›†åˆä¸º$\text{FIRST}({\beta}_1) \cup \text{FIRST}({\beta}_2) \cup \ldots \cup \text{FIRST}({\beta}_n)$, å…¶ä¸­${\beta}_n$ä¸º$\beta$ä¸­é¦–ä¸ª$\text{FIRST}$ä¸åŒ…å«$\epsilon$çš„ç¬¦å·.<br>ä½†è¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜: $\text{FIRST}(\epsilon)$ä¸º$\{\epsilon\}$, å¯¼è‡´æ— æ³•åŒ¹é…ä»»ä½•è¯ç±», ä¹Ÿå¯ä»¥è¯´, å¯ä»¥åŒ¹é…ä»»ä½•è¯ç±». å› æ­¤éœ€è¦å®šä¹‰ä¸€ä¸ªæ–°çš„é›†åˆ$\text{FOLLOW(A)}$, è¡¨ç¤ºç´§æ¥nonterminal symbol Aä¹‹åå‡ºç°çš„ç¬¦å·é›†åˆ. ä»¥ä¸‹æ˜¯è®¡ç®—$\text{FOLLOW}$é›†åˆçš„ç®—æ³•:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">for each A $\in$ NT do;</span><br><span class="line">  $\text&#123;FOLLOW&#125;$(A) $\leftarrow \phi$;</span><br><span class="line">end;</span><br><span class="line">$\text&#123;FOLLOW&#125;$(S) $\leftarrow$ &#123;eof&#125; ;</span><br><span class="line">while ($\text&#123;FOLLOW&#125;$ sets are still changing) do;</span><br><span class="line">  for each $p \in P$ of the form $A \rightarrow &#123;\beta&#125;_1 &#123;\beta&#125;_2 \cdots &#123;\beta&#125;_k$ do;</span><br><span class="line">    $\text&#123;TRAILER&#125; \leftarrow \text&#123;FOLLOW&#125;$(A);</span><br><span class="line">    for i $\leftarrow$ k down to 1 do;</span><br><span class="line">      if $&#123;\beta&#125;_i \in \text&#123;NT&#125;$ then begin;</span><br><span class="line">        $FOLLOW(&#123;\beta&#125;_i) \leftarrow \text&#123;FOLLOW&#125;(&#123;\beta&#125;_i) \ \cup \ \text&#123;TRAILER&#125;$;</span><br><span class="line">        if $\epsilon \in \text&#123;FIRST&#125;(&#123;\beta&#125;+i)$</span><br><span class="line">          $\text&#123;TRAILER&#125; \leftarrow \text&#123;TRAILER&#125; \cup (\text&#123;FIRST&#125;(&#123;\beta&#125;_i) âˆ’\epsilon)$;</span><br><span class="line">        else</span><br><span class="line">          $\text&#123;TRAILER&#125; \leftarrow \text&#123;FIRST&#125;(&#123;\beta&#125;_i)$;</span><br><span class="line">      else </span><br><span class="line">        $\text&#123;TRAILER&#125; \leftarrow \text&#123;FIRST&#125;(&#123;\beta&#125;_i)$; // is &#123;$&#123;\beta&#125;_i$&#125;</span><br><span class="line">    end;</span><br><span class="line">  end;</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>
<p>è¯¥ç®—æ³•åŸºäºä¹‹å‰çš„$\text{FIRST}$é›†åˆ. TRAILERè¡¨ç¤ºå‰ä¸€ä¸ªå­—ç¬¦å¯èƒ½æ‰¿æ¥çš„ç¬¦å·é›†åˆ. å‡è®¾productionä¸º$A \rightarrow \beta$, $\beta$å¯ä»¥è¡¨ç¤ºä¸ºå¤šä¸ªç¬¦å·çš„è¿æ¥${\beta}_1 {\beta}_2 \cdots {\beta}_k$. æ¯æ¬¡å¤„ç†productionæ—¶éƒ½éœ€åˆå§‹åŒ–TRAILERä¸º$\text{FOLLOW}(A)$, è¡¨ç¤º$\text{FOLLOW}({\beta}_n)$, ç„¶åä»åå‘å‰éå†æ¯ä¸ªç¬¦å·:</p>
<ol>
<li>è‹¥$\beta_i$ä¸ºterminal symbol, å°†TRAILERç½®ä¸º$\text{FIRST}(\beta_i)$é›†åˆ, è¡¨ç¤º$\text{FOLLOW}(\beta_{i-1})$</li>
<li>è‹¥${\beta}_i$ä¸ºnonterminal symbol, åˆ™å°†TRAILERå¹¶å…¥$\text{FOLLOW}(\beta_i)$, å¹¶é‡æ–°è®¾ç½®TRAILER:</li>
<li>è‹¥$\text{FIRST}({\beta}_i)$åŒ…å«$\epsilon$: å°†TRAILERç½®ä¸ºé™¤$\epsilon$çš„$\text{FIRST}({\beta}_i)$æ‰€æœ‰ç¬¦å·</li>
<li>è‹¥$\text{FIRST}({\beta}_i)$ä¸åŒ…å«$\epsilon$: å°†TRAILERç½®ä¸º$\text{FIRST}({\beta}_i)$</li>
</ol>
<p>ç®—æœ¯è¡¨è¾¾å¼çš„FOLLOWé›†åˆå¦‚ä¸‹:</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">Expr</th>
<th align="center">Expr&#39;</th>
<th align="center">Term</th>
<th align="center">Term&#39;</th>
<th align="center">Factor</th>
</tr>
</thead>
<tbody><tr>
<td align="center">FOLLOW</td>
<td align="center">eof, $\underline{)}$</td>
<td align="center">eof, $\underline{)}$</td>
<td align="center">eof, +, -, $\underline{)}$</td>
<td align="center">eof, +, -, $\underline{)}$</td>
<td align="center">eof, +, -, $\times$, $\div$, $\underline{)}$</td>
</tr>
</tbody></table>
<p>ä½¿ç”¨FIRSTå’ŒFOLLOWé›†åˆ, å¯ä»¥è§„å®šä¸€ä¸ªå¢å¼ºç‰ˆFIRST: $\text{FIRST}^+$<br>$$<br>\text{FIRST}^+(A \rightarrow \beta) &#x3D;<br>\begin{cases}<br>\text{FIRST}(\beta), &amp; \text{if} \ \epsilon \notin \text{FIRST}(\beta)\\<br>\text{FIRST}(\beta) \cup \text{FOLLOW}(A), &amp; \text{otherwise}<br>\end{cases}<br>$$</p>
<p>å¯¹äºæŸä¸ªnonterminal symbol A, å­˜åœ¨å¤šä¸ªproduction $A \rightarrow {\beta}_1 | {\beta}_2 | \cdots | {\beta}_n$, æ— å›æº¯çš„è¯­æ³•å¿…å®šå…·æœ‰ä»¥ä¸‹å±æ€§:<br>$$<br>\text{FIRST}^+(A \rightarrow {\beta}_i) \cap \text{FIRST}^+(A \rightarrow {\beta}_j) &#x3D; \phi, \ \forall \ 1 \leq i, j \leq b, i \neq j<br>$$</p>
<p>ä»¥ä¸‹æ˜¯ç®—æœ¯è¡¨è¾¾å¼çš„å…¨éƒ¨$\text{FIRST}^+$:</p>
<table>
<thead>
<tr>
<th align="center">Production</th>
<th align="center">$\text{FIRST}^+$</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Expr $\rightarrow$ Term Expr&#39;</td>
<td align="center">$\underline{(}$, name, num</td>
</tr>
<tr>
<td align="center">Expr&#39; $\rightarrow$ + Term Expr&#39;</td>
<td align="center">+</td>
</tr>
<tr>
<td align="center">Expr&#39; $\rightarrow$ - Term Expr&#39;</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">Expr&#39; $\rightarrow \epsilon$</td>
<td align="center">$\underline{)}$, eof, $\epsilon$</td>
</tr>
<tr>
<td align="center">Term $\rightarrow$ Factor Term&#39;</td>
<td align="center">$\underline{(}$, name, num</td>
</tr>
<tr>
<td align="center">Term&#39; $\rightarrow \times$ Factor Term&#39;</td>
<td align="center">$\times$</td>
</tr>
<tr>
<td align="center">Term&#39; $\rightarrow \div$ Factor Term&#39;</td>
<td align="center">$\div$</td>
</tr>
<tr>
<td align="center">Term&#39; $\rightarrow \epsilon$</td>
<td align="center">+, -, $\underline{)}$, eof, $\epsilon$</td>
</tr>
<tr>
<td align="center">Factor $rightarrow$ (Expr)</td>
<td align="center">$\underline{(}$</td>
</tr>
<tr>
<td align="center">Factor $rightarrow$ num</td>
<td align="center">num</td>
</tr>
<tr>
<td align="center">Factor $rightarrow$ name</td>
<td align="center">name</td>
</tr>
</tbody></table>
<h4 id="3-1-4-Left-Factoring-to-Eliminate-Backtracking"><a href="#3-1-4-Left-Factoring-to-Eliminate-Backtracking" class="headerlink" title="3.1.4 Left-Factoring to Eliminate Backtracking"></a>3.1.4 Left-Factoring to Eliminate Backtracking</h4><p>å¹¶éæ‰€æœ‰è¯­å¥éƒ½æ˜¯æ— å›æº¯çš„, ä»¥ä¸‹é¢çš„è¯­æ³•è§„åˆ™ä¸ºä¾‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">11 $\textit&#123;Factor&#125; \rightarrow \text&#123;name&#125;$</span><br><span class="line">12     $| \rightarrow \text&#123;name&#125;$</span><br><span class="line">13     $| \rightarrow \text&#123;name&#125; \underline&#123;[&#125; \textit&#123;ArgList&#125; \underline&#123;]&#125;$</span><br><span class="line">14     $| \rightarrow \text&#123;name&#125; \underline&#123;(&#125; \textit&#123;ArgList&#125; \underline&#123;)&#125;$</span><br><span class="line">15 $\textit&#123;ArgList&#125; \rightarrow \ \textit&#123;Expr&#125; \ \textit&#123;MoreArgs&#125;$</span><br><span class="line">16 $\textit&#123;MoreArgs&#125; \rightarrow \ , \ \textit&#123;Expr&#125; \ \textit&#123;MoreArgs&#125;$</span><br><span class="line">17         $| \ \epsilon$</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°, ç¬¬11, 12, 13è§„åˆ™çš„$\text{FIRST}^+$é›†åˆæ˜¯ç›¸åŒçš„, éƒ½æ˜¯name, å¯èƒ½å¯¼è‡´å›æº¯. å¯ä»¥è½¬æ¢productionæ¥ç”Ÿæˆä¸ç›¸äº¤çš„$\text{FIRST}^+$é›†åˆ:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">11 $\textit&#123;Factor&#125; \rightarrow \text&#123;name&#125; \textit&#123;Arguments&#125;$</span><br><span class="line">12 $\textit&#123;Arguments&#125; \rightarrow \underline&#123;[&#125; ArgList \underline&#123;]&#125;$</span><br><span class="line">13       $| \ \rightarrow \underline&#123;(&#125; ArgList \underline&#123;)&#125;$</span><br><span class="line">14       $| \ \rightarrow \epsilon$</span><br></pre></td></tr></table></figure>
<p>é‡å†™$\textit{Factor}$åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤, ç§°ä¸ºleft factoring(æå–å·¦å› å­):</p>
<ol>
<li>åŒ¹é…è§„åˆ™ä¸­çš„å…¬å…±å‰ç¼€</li>
<li>ä¸ºä¸åŒçš„åç¼€æ·»åŠ ä¸€ä¸ªæ–°çš„nonterminal symbol: $\textit{Arguments}$</li>
</ol>
<p>å½¢å¼ä¸Šæè¿°: å¯¹äºproduction $A \rightarrow \alpha \beta_1 | \alpha \beta_2 | \cdots | \alpha \beta_n | \gamma_1 | \gamma_2 | \cdots | \gamma_j$, $\alpha$ä¸ºå…¬å…±å‰ç¼€, $\gamma_i$è¡¨ç¤ºä¸ä»$\alpha$å¼€å§‹å³ä¾§å¥å‹. è½¬æ¢åç”¨æ–°çš„nonterminal symbol Bæ¥è¡¨ç¤ºåç¼€:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$A \rightarrow \alpha B | \gamma_1 | \gamma_2 | \cdots | \gamma_j$</span><br><span class="line">$B \rightarrow \beta_1 | \beta_2 | \cdots | \beta_n$</span><br></pre></td></tr></table></figure>

<h3 id="3-2-Top-Down-Recursive-Descent-Parser"><a href="#3-2-Top-Down-Recursive-Descent-Parser" class="headerlink" title="3.2 Top-Down Recursive-Descent Parser"></a>3.2 Top-Down Recursive-Descent Parser</h3><p>é€’å½’ä¸‹é™çš„æ— å›æº¯parseråœ¨ç»“æ„ä¸Šå‘ˆç°ä¸ºä¸€ç»„ç›¸äº’é€’å½’çš„è¿‡ç¨‹, æ¯ä¸ªnonterminal symboléƒ½å¯¹äºä¸€ä¸ª<strong>è¿‡ç¨‹</strong>. ä¾‹å¦‚: nonterminal symbol Açš„è¿‡ç¨‹å¯ä»¥è¯†åˆ«è¾“å…¥æµä¸­çš„Aå®ä¾‹. ä¸ºè¯†åˆ«Açš„äº§ç”Ÿå¼ä¸­çš„nonterminal symbol B, éœ€è¦è°ƒç”¨Bçš„<strong>è¿‡ç¨‹</strong>. ä»¥ä¸‹æ˜¯${Expr}&#39;$çš„å³é€’å½’è¡¨è¾¾å¼è¯­æ³•:</p>
<table>
<thead>
<tr>
<th align="center">Production</th>
<th align="center">$\text{FIRST}^+$</th>
</tr>
</thead>
<tbody><tr>
<td align="center">$\text{Expr}&#39; \rightarrow + \ \text{Term} \ \text{Expr}&#39;$</td>
<td align="center">$ + $</td>
</tr>
<tr>
<td align="center">$\qquad \ | \ - \ \text{Term} \ \text{Expr}&#39;$</td>
<td align="center">$ - $</td>
</tr>
<tr>
<td align="center">$\qquad \ | \ \epsilon$</td>
<td align="center">$ \epsilon, \text{eof}, ) $</td>
</tr>
</tbody></table>
<p>ä¸ºè¯†åˆ«$\text{Expr}&#39;$, éœ€è¦åˆ›å»ºä¸€ä¸ªå‡½æ•°åä¸ºEPrime(), éµå¾ªä¸€ä¸ªç®€å•çš„æ¨¡å¼: æ ¹æ®${\text{FIRST}^+}$é›†åˆå’ŒåŒ¹é…è¾“å…¥æµä¸­çš„ç¬¦å·. ä»¥ä¸‹æ˜¯EPrimeçš„ä»£ç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">EPrime()</span><br><span class="line">  /* $\text&#123;Expr&#125;&#x27; \rightarrow + \ \text&#123;Term&#125; \ \text&#123;Expr&#125;&#x27; \ | - \text&#123;Term&#125; \ \text&#123;Expr&#125;&#x27;$ */</span><br><span class="line">  if (word = + or word = -)</span><br><span class="line">    word $\leftarrow$ NextWord();</span><br><span class="line">    if (Term())</span><br><span class="line">      return EPrime();</span><br><span class="line">    else </span><br><span class="line">      return false;</span><br><span class="line">  else if (word = $\underline&#123;)&#125;$ or word = eof) /* $\text&#123;Expr&#125;&#x27; \rightarrow \epsilon $ */</span><br><span class="line">      return true;</span><br><span class="line">  else /* no match */</span><br><span class="line">    report a syntax error;</span><br><span class="line">  return false;</span><br></pre></td></tr></table></figure>
<p>æ„å»ºtop-Down recursive-descent parserçš„ç­–ç•¥æ¯”è¾ƒç®€å•: ä¸ºæ¯ä¸ªnonterminal symbolæ„å»ºä¸€ä¸ª<strong>è¿‡ç¨‹</strong>æ¥è¯†åˆ«ä¸ä¹‹åŒ¹é…çš„äº§ç”Ÿå¼. ç›´æ¥è¿‡ç¨‹å½¼æ­¤åµŒå¥—å¹¶äº’ç›¸è°ƒç”¨, å¹¶å¯åœ¨æ— æ³•æ‰¾åˆ°é¢„æœŸterminal symbolæ—¶ç”Ÿæˆé”™è¯¯ä¿¡æ¯:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/* Goal $\rightarrow$ Expr */</span><br><span class="line">Main( )</span><br><span class="line">  word $&#123;leftarrow&#125;$ NextWord( );</span><br><span class="line">  if (Expr( ))</span><br><span class="line">    if (word = eof )</span><br><span class="line">      report success;</span><br><span class="line">    else</span><br><span class="line">      Fail( );</span><br><span class="line"></span><br><span class="line">Fail( )</span><br><span class="line">  report syntax error;</span><br><span class="line">  attempt error recovery or exit;</span><br><span class="line"></span><br><span class="line">/* Expr $\rightarrow$ Term Expr&#x27;*/</span><br><span class="line">Expr( )</span><br><span class="line">  if (Term( ))</span><br><span class="line">    return EPrime( );</span><br><span class="line">  else</span><br><span class="line">    Fail();</span><br><span class="line"></span><br><span class="line">/* Expr&#x27; $\rightarrow$ + Term Expr&#x27; */</span><br><span class="line">/* Expr&#x27; $\rightarrow$ - Term Expr&#x27; */</span><br><span class="line">EPrime( )  </span><br><span class="line">  if (word = + or word = - )</span><br><span class="line">    word $\leftarrow$  NextWord( );</span><br><span class="line">    if (Term())</span><br><span class="line">      return EPrime( );</span><br><span class="line">    else</span><br><span class="line">      Fail();</span><br><span class="line">  else if (word = ) or word = eof)</span><br><span class="line">    return true; /* $\text&#123;Expr&#125;&#x27; \rightarrow \epsilon$ */</span><br><span class="line">  else</span><br><span class="line">    Fail();</span><br><span class="line"></span><br><span class="line">/* Term $\rightarrow$ Factor Term&#x27; */</span><br><span class="line">Term( )</span><br><span class="line">  if (Factor())</span><br><span class="line">    return TPrime( );</span><br><span class="line">  else</span><br><span class="line">    Fail();</span><br><span class="line"></span><br><span class="line">/* Term&#x27; $\rightarrow \times$ Factor Term&#x27; */</span><br><span class="line">/* Term&#x27; $\rightarrow \div$ Factor Term&#x27; */</span><br><span class="line">TPrime( ) </span><br><span class="line">  if (word = $\times$ or word = $\div$)</span><br><span class="line">    word $\leftarrow$ NextWord( );</span><br><span class="line">    if (Factor( ))</span><br><span class="line">      return TPrime( );</span><br><span class="line">    else</span><br><span class="line">      Fail();</span><br><span class="line">  else if (word = + or word = - or word = ) or word = eof)</span><br><span class="line">    return true; /* Term&#x27; $\rightarrow \epsilon$ */</span><br><span class="line">  else</span><br><span class="line">    Fail();</span><br><span class="line"></span><br><span class="line">/* Factor $\rightarrow$ (Expr) */</span><br><span class="line">Factor( )</span><br><span class="line">  if (word = $\underline&#123;(&#125;$ )</span><br><span class="line">    word $\leftarrow$ NextWord( );</span><br><span class="line">    if (not Expr( ))</span><br><span class="line">      Fail();</span><br><span class="line">    if (word $\neq \underline&#123;)&#125;$)</span><br><span class="line">      Fail();</span><br><span class="line">    word $\leftarrow$ NextWord( );</span><br><span class="line">    return true;</span><br><span class="line">  /* Factor $\rightarrow$ num */</span><br><span class="line">  /* Factor $\rightarrow$ name */</span><br><span class="line">  else if (word = num or word = name)</span><br><span class="line">    word $\leftarrow$ NextWord( );</span><br><span class="line">    return true;</span><br><span class="line">  else</span><br><span class="line">    Fail();</span><br></pre></td></tr></table></figure>


<h3 id="3-3-Table-Driven-LL-1-Parser"><a href="#3-3-Table-Driven-LL-1-Parser" class="headerlink" title="3.3 Table-Driven LL(1) Parser"></a>3.3 Table-Driven LL(1) Parser</h3><p>å¯¹äºæ— å›æº¯è¯­æ³•, ä½¿ç”¨$\text{FIRST}^+$é›†åˆå¯ä»¥å®ç°top-down parser, ç§°ä¸º<strong>LL(1)</strong>. è¯¥è¯­æ³•åˆ†æå™¨ç”±å·¦(Left)åˆ°å³æ‰«æè¾“å…¥, æ„å»ºä¸€ä¸ªæœ€å·¦æ¨å¯¼(Leftmost), å…¶ä¸­ä»…ä½¿ç”¨ä¸€ä¸ªå‰ç»ç¬¦å·(1). ä»¥ä¸‹æ˜¯LL(1)çš„ç®—æ³•:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">word $\leftarrow$ NextWord( );</span><br><span class="line">push eof onto Stack;</span><br><span class="line">push the start symbol, S, onto Stack;</span><br><span class="line">focus $\leftarrow$ top of Stack;</span><br><span class="line">while (1)</span><br><span class="line">  if (focus = eof and word = eof)</span><br><span class="line">    report success and exit the loop;</span><br><span class="line">  else if (focus $\in$ T or focus = eof)</span><br><span class="line">    if focus matches word</span><br><span class="line">      pop Stack;</span><br><span class="line">      word $\leftarrow$ NextWord( );</span><br><span class="line">    else</span><br><span class="line">      report an error looking for symbol at top of stack;</span><br><span class="line">  else /* focus is a nonterminal */</span><br><span class="line">    if Table[focus, word] is $A \rightarrow B_1 B_2 \cdots B_k$</span><br><span class="line">      pop Stack;</span><br><span class="line">      for i $\leftarrow$ k to 1 by -1 do;</span><br><span class="line">        if ($B_i \neq\epsilon$)</span><br><span class="line">          push $B_i$ onto Stack;</span><br><span class="line">    else</span><br><span class="line">      report an error expanding focus;</span><br><span class="line">  focus $\leftarrow$ top of Stack;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸‹æ˜¯LL(1)çš„å³é€’å½’è¡¨è¾¾å¼è¯­æ³•è¡¨:</p>
<p>| | eof | + | - | $\times$ | $\div$ | $\underline{(}$ | $\underline{)}$ | name | num |<br>|:---:||:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:<br>| Goal  | - | - | - | - | - | 0 | - | 0 | 0 |<br>| Expr  | - | - | - | - | - | 1 | - | 1 | 1 |<br>| Expr&#39; | 4 | 2 | 3 | - | - | - | 4 | - | - |<br>| Term  | - | - | - | - | - | 5 | - | 5 | 5 |<br>| Term&#39; | 8 | 8 | 8 | 6 | 7 | - | 8 | - | - |<br>| Factor| - | - | - | - | - | 9 | - | 11| 10|</p>
<p>ä¸ºæ„å»ºLL(1)è¯­æ³•åˆ†æå™¨, compileréœ€è¦ä¸€ä¸ªå³é€’å½’ä¸”æ— å›æº¯çš„è¯­æ³•, å’Œä¸€ä¸ªparser generatoræ¥æ„é€ parser. LL(1) parser generatoræœ€å¸¸è§çš„æŠ€æœ¯å°±æ˜¯table-driven skeleton parser. è¯­æ³•åˆ†æè¡¨å°†nonterminal symbolå’Œå‰ç»ç¬¦å·æ˜ å°„åˆ°å¯¹åº”çš„äº§ç”Ÿå¼, ç»™å®šnonterminal symbol Aå’Œå‰ç»ç¬¦å·w, Table[A, w]æŒ‡å®šç”¨äºæ‰©å±•è¯¥è¯­æ³•æ ‘çš„äº§ç”Ÿå¼. ä»¥ä¸‹æ˜¯æ„é€ Tableçš„ç®—æ³•:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">build $\text&#123;FIRST&#125;$, $\text&#123;FOLLOW&#125;$ and $\text&#123;FIRST&#125;^+$ sets</span><br><span class="line">for each nonterminal symbol A do:</span><br><span class="line">  for each terminal w do;</span><br><span class="line">    Table[A, w] $\leftarrow$ error;</span><br><span class="line">  for each production p of the form $A \rightarrow \beta$ do;</span><br><span class="line">    for each terminal w $\in \text&#123;FIRST&#125;^+(A \rightarrow \beta)$ do;</span><br><span class="line">      Table[A, w] $\leftarrow$ p;</span><br><span class="line">    if eof $\in \text&#123;FIRST&#125;^+(A \rightarrow \beta$)</span><br><span class="line">      Table[A, eof] $\leftarrow$ p;</span><br></pre></td></tr></table></figure>
<p>å¯¹äºè¾“å…¥æµ$a + b \times c$, ä»¥ä¸‹æ˜¯æ•´ä¸ªè¯­æ³•åˆ†æè¿‡ç¨‹:</p>
<table>
<thead>
<tr>
<th align="center">Rule</th>
<th align="center">Stack</th>
<th align="center">Input</th>
</tr>
</thead>
<tbody><tr>
<td align="center">-</td>
<td align="center">eof Goal</td>
<td align="center">$\uparrow$ name + name $\times$ name</td>
</tr>
<tr>
<td align="center">0</td>
<td align="center">eof Expr</td>
<td align="center">$\uparrow$ name + name $\times$ name</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">eof Expr&#39; Term</td>
<td align="center">$\uparrow$ name + name $\times$ name</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">eof Expr&#39; Term&#39; Factor</td>
<td align="center">$\uparrow$ name + name $\times$ name</td>
</tr>
<tr>
<td align="center">11</td>
<td align="center">eof Expr&#39; Term&#39; name</td>
<td align="center">$\uparrow$ name + name $\times$ name</td>
</tr>
<tr>
<td align="center">$\rightarrow$</td>
<td align="center">eof Expr&#39; Term&#39;</td>
<td align="center">name $\uparrow$ + name $\times$ name</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">eof Expr&#39;</td>
<td align="center">name $\uparrow$ + name $\times$ name</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">eof Expr&#39; Term +</td>
<td align="center">name $\uparrow$ + name $\times$ name</td>
</tr>
<tr>
<td align="center">$\rightarrow$</td>
<td align="center">eof Expr&#39; Term</td>
<td align="center">name + $\uparrow$ name $\times$ name</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">eof Expr&#39; Term&#39; Factor</td>
<td align="center">name + $\uparrow$ name $\times$ name</td>
</tr>
<tr>
<td align="center">11</td>
<td align="center">eof Expr&#39; Term&#39; name</td>
<td align="center">name + $\uparrow$ name $\times$ name</td>
</tr>
<tr>
<td align="center">$\rightarrow$</td>
<td align="center">eof Expr&#39; Term&#39;</td>
<td align="center">name + name $\uparrow$ $\times$ name</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">eof Expr&#39; Term&#39; Factor $\times$</td>
<td align="center">name + name $\uparrow$ $\times$ name</td>
</tr>
<tr>
<td align="center">$\rightarrow$</td>
<td align="center">eof Expr&#39; Term&#39; Factor</td>
<td align="center">name + name $\times$ $\uparrow$ name</td>
</tr>
<tr>
<td align="center">11</td>
<td align="center">eof Expr&#39; Term&#39; name</td>
<td align="center">name + name $\times$ $\uparrow$ name</td>
</tr>
<tr>
<td align="center">$\rightarrow$</td>
<td align="center">eof Expr&#39; Term&#39;</td>
<td align="center">name + name $\times$ name $\uparrow$</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">eof Expr&#39;</td>
<td align="center">name + name $\times$ name $\uparrow$</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">eof</td>
<td align="center">name + name $\times$ name $\uparrow$</td>
</tr>
</tbody></table>

    </div>

    <footer class="post-footer">
      
      <div class="post-tags">
        
          <a href="/tags/Compiler/">Compiler</a>
        
      </div>
      

      
      
  <nav class="post-nav">
    
      <a class="prev" href="/p/610c.html">
        <i class="icon-left"></i>
        <span class="prev-text nav-default">Parser (2)</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/p/d5c.html">
        <span class="next-text nav-default">Scanner (2)</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="icon-right"></i>
      </a>
    
  </nav>

      
    </footer>
  </article>

  </div>
  
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    showProcessingMessages: true,
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: false,
        skipTags: ["script","noscript","style","textarea"]
    },
    TeX: {
        Macros:{
            Arr: ["\\{ #1 \\}", 1],
            fi: "{f\\,\\!_i}",
            SS: ["{#1\\:\\!_#2}",2],
            SUBx: ["{\\:\\!_#1}",1],
            EXPx: ["{\\;\\!^#1}",1],
            Ss: ["{#1\\,\\!_#2}",2],
            subx: ["{\\,\\!_#1}",1]
        }
    }
});
</script>


      </div>
    </div>

    
<script type="text/javascript">
  var disqus_shortname = 'zaf1ro';
  var disqus_identifier = 'p/52ae.html';
  var disqus_title = "Parser (1)";

  var disqus = {
    load : function disqus(){
        if(typeof DISQUS !== 'object') {
          (function () {
          var s = document.createElement('script'); s.async = true;
          s.type = 'text/javascript';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
          }());
          $('#load-disqus').remove(); ///åŠ è½½åç§»é™¤æŒ‰é’®
        }
    }
  }

  
    var disqus_config = function () {
        this.page.url = disqus_url;
        this.page.identifier = disqus_identifier;
        this.page.title = disqus_title;
    };
  

</script>



    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.6.0.min.js"></script>
  

  

    
    <script type="text/javascript">
(function(){"use strict";var Theme={};Theme.backToTop={register:function(){var $backToTop=$('#back-to-top');$(window).scroll(function(){if($(window).scrollTop()>100){$backToTop.fadeIn(1000)}else{$backToTop.fadeOut(1000)}});$backToTop.click(function(){$('body').animate({scrollTop:0})})}};Theme.fancybox={register:function(){if($.fancybox){$('.post').each(function(){$(this).find('img').each(function(){$(this).wrap('<a class="fancybox" href="'+this.src+'" title="'+this.alt+'"></a>')})});$('.fancybox').fancybox({openEffect:'elastic',closeEffect:'elastic'})}}};this.Theme=Theme}.call(this));
</script>

<script type="text/javascript">
$(document).ready(function(){if(themeConfig.fancybox.enable){Theme.fancybox.register()}Theme.backToTop.register()});
</script>
    
<script type="text/javascript">
var themeConfig = {
  fancybox: {
    enable: false
  },
};
</script>

    <script>
    $('table').wrap('<div style="overflow-x: auto;"></div>');
</script>
    
    <script>
$(document).ready(function () {
    $('#sidebarCollapse').on('click', function(){
        $('#sidebar').toggleClass('active');
    });

    $('#toc ol li a').on('click', function(){
        $('#sidebar').toggleClass('active');
    });
});
</script>
  </body>
</html>
