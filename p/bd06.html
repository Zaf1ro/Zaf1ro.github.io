<!DOCTYPE html>
<html lang="zh">
  <head>
    
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">



  <meta name="description" content="CRC (Cyclic Redundancy Check)"/>




  <meta name="keywords" content="Network," />


<meta name="google-site-verification" content="qy4gf0StWj627u-7aIP3WDCLBi3jPYXhm57UC7TUcok" />
<meta name="baidu-site-verification" content="XJoPG7ad2Z" />

<link rel="alternate" hreflang="x-default" href="https://zaf1ro.github.io/p/bd06.html" />
<link rel="alternate" hreflang="zh" href="https://zaf1ro.github.io/p/bd06.html" />




  <link rel="alternate" href="/default" title="Zaf1ro" >




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.jpeg?v=1.1" />



<link rel="canonical" href="https://zaf1ro.github.io/p/bd06.html"/>


<meta name="description" content="1. Cyclic Redundancy CheckCRC(循环冗余校验,Cyclic Redundary Check)是一种根据数据产生的简短固定位数校验码的一种散列函数, 主要用于检测或校验数据传输或保存后可能出现的错误 2. Error Control CodingError Control Coding(差错控制编码): 在要传输的k个bit数据后添加n-k比特的冗余位, 这样形成的n个b">
<meta property="og:type" content="article">
<meta property="og:title" content="CRC (Cyclic Redundancy Check)">
<meta property="og:url" content="https://zaf1ro.github.io/p/bd06.html">
<meta property="og:site_name" content="Zaf1ro">
<meta property="og:description" content="1. Cyclic Redundancy CheckCRC(循环冗余校验,Cyclic Redundary Check)是一种根据数据产生的简短固定位数校验码的一种散列函数, 主要用于检测或校验数据传输或保存后可能出现的错误 2. Error Control CodingError Control Coding(差错控制编码): 在要传输的k个bit数据后添加n-k比特的冗余位, 这样形成的n个b">
<meta property="og:locale">
<meta property="article:published_time" content="2016-10-22T18:56:56.000Z">
<meta property="article:modified_time" content="2024-08-20T16:43:04.044Z">
<meta property="article:tag" content="Network">
<meta name="twitter:card" content="summary">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1" />




    <title>
CRC (Cyclic Redundancy Check) - Zaf1ro
</title>
  <meta name="generator" content="Hexo 6.3.0"></head>

  <body>
  <nav id="sidebar" class="active on-post">
    <div id="third">
      <div id="sidebar-title">
        <h1 id="sidebar-title-text">
            <a href="/." class="logo">Home</a>
        </h1>
      </div>
      <div id="google-search">
  <script async src="https://cse.google.com/cse.js?cx=009060789867951546370:v3hkcobeuh9"></script>
  <div class="gcse-search"></div>
</div>
      
  <div id="toc">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Cyclic-Redundancy-Check"><span class="toc-text">1. Cyclic Redundancy Check</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Error-Control-Coding"><span class="toc-text">2. Error Control Coding</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-FCS-in-Ethernet"><span class="toc-text">3. FCS in Ethernet</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Header-Checksum-in-IP"><span class="toc-text">4. Header Checksum in IP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Checksum-in-TCP"><span class="toc-text">5. Checksum in TCP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Checksum-in-UDP"><span class="toc-text">6. Checksum in UDP</span></a></li></ol>
  </div>

    </div>
  </nav>

    <div id="page">
      <header id="masthead"><div class="site-header-inner">
  
  <button class="nav-mobile-button on-post" id="sidebarCollapse">
  
    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><path d="M24 6h-24v-4h24v4zm0 4h-24v4h24v-4zm0 8h-24v4h24v-4z"/></svg>
  </button>
  
  


  <nav id="nav-top">
    
      
      <ul id="menu-top" class="nav-top-items on-post">
      
        
          <li class="menu-item">
            <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Zaf1ro">
              
              
                Github
              
            </a>
          </li>
        
      </ul>
    
  </nav>
</div>

      </header>
      <div id="content">
        
  <div class="primary">
    
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          CRC (Cyclic Redundancy Check)
        
      </h1>
      <time class="post-time">
          10/22/16
      </time>
    </header>

    <div class="post-content">
      <h2 id="1-Cyclic-Redundancy-Check"><a href="#1-Cyclic-Redundancy-Check" class="headerlink" title="1. Cyclic Redundancy Check"></a>1. Cyclic Redundancy Check</h2><p>CRC(循环冗余校验,Cyclic Redundary Check)是一种根据数据产生的简短固定位数校验码的一种散列函数, 主要用于检测或校验数据传输或保存后可能出现的错误</p>
<h2 id="2-Error-Control-Coding"><a href="#2-Error-Control-Coding" class="headerlink" title="2. Error Control Coding"></a>2. Error Control Coding</h2><p>Error Control Coding(差错控制编码): 在要传输的k个bit数据后添加n-k比特的冗余位, 这样形成的n个bit的传输帧作为整体传输. 所添加的n-k个bit数据必须满足以下两个规则:</p>
<ol>
<li><code>T mod P == 0</code></li>
<li><code>T = 2^(n-k)*D + F</code></li>
</ol>
<p>其中P是双方原定的除数, F为帧检验序列(FCS, Frame Check Sequence), 对端接受到数据后可通过第一条规则来检测数据是否出错, 为0则没错, 为1则丢弃数据.</p>
<h2 id="3-FCS-in-Ethernet"><a href="#3-FCS-in-Ethernet" class="headerlink" title="3. FCS in Ethernet"></a>3. FCS in Ethernet</h2><p>以下是有关FCS(帧检验序列)的流程如下:</p>
<ol>
<li>在进行CRC检验时, 发送方和接收方先预先规定一个除数, 成为G(x), 最高位和最低位必须为1</li>
<li>假设信息字段为K位, 校验字段为R位, 则总长度为K+R, 双方预先预定的多项式为<code>G(x)</code>, 则<code>V(x)=A(x)G(x)=xRM(x)+r(x)</code>. <code>M(x)</code>为K位的信息多项式, <code>r(x)</code>为R-1位的检验多项式</li>
</ol>
<p>Ethernet的帧校验序列(FCS)为4字节, 使用差错控制编码, 例如:<br>信息字段为<code>1101011011</code>(长度为10位, M(x)), 检验字段<code>G(x)=x^4+x+1(r=4)</code>, 所以除数为10011, <code>1101011011(0000) / 10011 = 1110</code>, 发送帧为<code>(1101011011)(1110)</code>, 接收端计算: <code>11010110111110 / 10011 = 0</code>, 数据正确; 若接受端发现商不为0, 则数据不正确</p>
<h2 id="4-Header-Checksum-in-IP"><a href="#4-Header-Checksum-in-IP" class="headerlink" title="4. Header Checksum in IP"></a>4. Header Checksum in IP</h2><p>IP层的校验功能由IP报文的<strong>Header Checksum</strong>(首部校验和)实现, 正如名称所写, 首部校验和只针对IP报文的首部, 数据部分都交给了下一层的校验码进行校验, 长度为16bit. 步骤如下:</p>
<ol>
<li>首部校验和的字段设为0</li>
<li>将首部其他字段分为几个单位长度为16位的字段</li>
<li>将所有字段相加, 如果相加的和超过了16位, 则将超出部分加入最低位</li>
<li>和取反则为校验位</li>
</ol>
<p>例如: IP首部字段为: <code>4500 0028 272a 4000 4006 c0a8 0064 0e98 4c1b</code>, 首部之和为: <code>2 0817</code>; 由于首部之和超过16位, 因此把将2加入<code>0817</code>, 变为<code>0819</code>. 对<code>0819</code>取反, 为<code>F7E6</code>, 因此该IP报文的首部校验码为<code>F7E6</code>.</p>
<h2 id="5-Checksum-in-TCP"><a href="#5-Checksum-in-TCP" class="headerlink" title="5. Checksum in TCP"></a>5. Checksum in TCP</h2><p>TCP的校验码算法与IP层相同(16bits的字段相加, 多出16bits的位数加到尾数上, 再取反), 但是校验的内容不仅是TCP层的数据, 还包括部分IP层的数据(Pseudo Header):</p>
<p>TCP部分:</p>
<ul>
<li>Source Port(16bits)</li>
<li>Destination Port(16bits)</li>
<li>Seq Number(32bits)</li>
<li>Ack Number(32bits)</li>
<li>Data Offset+Reverve+Flags(16bits)</li>
<li>Window Size(16bits)</li>
<li>Options(n bits)</li>
<li>Data(n bits)</li>
</ul>
<p>假IP头部:</p>
<ul>
<li>Source Address(32bits)</li>
<li>Destination Address(32bits)</li>
<li>Reverved(0x00)+Protocol(0x06)</li>
<li>TCP length(IP层的Total Length - IP层的Header Length)</li>
</ul>
<h2 id="6-Checksum-in-UDP"><a href="#6-Checksum-in-UDP" class="headerlink" title="6. Checksum in UDP"></a>6. Checksum in UDP</h2><p>算法与TCP的checksum计算相同, 只是校验的内容有所不同, 包含两部分:</p>
<ul>
<li>IP部分与TCP校验区域相同</li>
<li>UDP全部字段, 包括data部分</li>
</ul>

    </div>

    <footer class="post-footer">
      
      <div class="post-tags">
        
          <a href="/tags/Network/">Network</a>
        
      </div>
      

      
      
  <nav class="post-nav">
    
      <a class="prev" href="/p/1c3f.html">
        <i class="icon-left"></i>
        <span class="prev-text nav-default">PyObject</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/p/5730.html">
        <span class="next-text nav-default">SACK</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="icon-right"></i>
      </a>
    
  </nav>

      
    </footer>
  </article>

  </div>
  
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    showProcessingMessages: true,
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: false,
        skipTags: ["script","noscript","style","textarea"]
    },
    TeX: {
        Macros:{
            Arr: ["\\{ #1 \\}", 1],
            fi: "{f\\,\\!_i}",
            SS: ["{#1\\:\\!_#2}",2],
            SUBx: ["{\\:\\!_#1}",1],
            EXPx: ["{\\;\\!^#1}",1],
            Ss: ["{#1\\,\\!_#2}",2],
            subx: ["{\\,\\!_#1}",1]
        }
    }
});
</script>


      </div>
    </div>

    
<script type="text/javascript">
  var disqus_shortname = 'zaf1ro';
  var disqus_identifier = 'p/bd06.html';
  var disqus_title = "CRC (Cyclic Redundancy Check)";

  var disqus = {
    load : function disqus(){
        if(typeof DISQUS !== 'object') {
          (function () {
          var s = document.createElement('script'); s.async = true;
          s.type = 'text/javascript';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
          }());
          $('#load-disqus').remove(); ///加载后移除按钮
        }
    }
  }

  
    var disqus_config = function () {
        this.page.url = disqus_url;
        this.page.identifier = disqus_identifier;
        this.page.title = disqus_title;
    };
  

</script>



    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.6.0.min.js"></script>
  

  

    
    <script type="text/javascript">
(function(){"use strict";var Theme={};Theme.backToTop={register:function(){var $backToTop=$('#back-to-top');$(window).scroll(function(){if($(window).scrollTop()>100){$backToTop.fadeIn(1000)}else{$backToTop.fadeOut(1000)}});$backToTop.click(function(){$('body').animate({scrollTop:0})})}};Theme.fancybox={register:function(){if($.fancybox){$('.post').each(function(){$(this).find('img').each(function(){$(this).wrap('<a class="fancybox" href="'+this.src+'" title="'+this.alt+'"></a>')})});$('.fancybox').fancybox({openEffect:'elastic',closeEffect:'elastic'})}}};this.Theme=Theme}.call(this));
</script>

<script type="text/javascript">
$(document).ready(function(){if(themeConfig.fancybox.enable){Theme.fancybox.register()}Theme.backToTop.register()});
</script>
    
<script type="text/javascript">
var themeConfig = {
  fancybox: {
    enable: false
  },
};
</script>

    <script>
    $('table').wrap('<div style="overflow-x: auto;"></div>');
</script>
    
    <script>
$(document).ready(function () {
    $('#sidebarCollapse').on('click', function(){
        $('#sidebar').toggleClass('active');
    });

    $('#toc ol li a').on('click', function(){
        $('#sidebar').toggleClass('active');
    });
});
</script>
  </body>
</html>
